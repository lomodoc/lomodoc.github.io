<!doctype html><html lang=en dir=ltr><head><meta name=generator content="Hugo 0.78.1"><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Openwrt installation#Lomorage setup using opkg packages with Entware repository (need dependencies in Entware, like ffmpeg exif-tools).
This is currently in Beta, please reach us if you have any problem.
Quick Start#This is for users who want to setup Lomorage using opkg packets.
1. Install Entware#Follow the instruction to install Entware on target machine.
You can use cat /proc/cpuinfo to check the architecture:"><meta name=theme-color content="#FFFFFF"><meta property="og:title" content="Openwrt"><meta property="og:description" content="Openwrt installation#Lomorage setup using opkg packages with Entware repository (need dependencies in Entware, like ffmpeg exif-tools).
This is currently in Beta, please reach us if you have any problem.
Quick Start#This is for users who want to setup Lomorage using opkg packets.
1. Install Entware#Follow the instruction to install Entware on target machine.
You can use cat /proc/cpuinfo to check the architecture:"><meta property="og:type" content="article"><meta property="og:url" content="https://docs.lomorage.com/docs/Installation/lomorage-service/installation-openwrt/"><meta property="article:modified_time" content="2021-10-30T23:09:23-07:00"><title>Openwrt | Lomorage Documentation</title><link rel=manifest href=/manifest.json><link rel=icon href=/favicon.png type=image/x-icon><link rel=alternate hreflang=zh href=https://docs.lomorage.com/zh/docs/Installation/lomorage-service/installation-openwrt/ title=Openwrt><link rel=stylesheet href=/book.min.d805fe2ebdefe4129affdf99919216bbf7f9e3d6ed05e1b743c4e4266ceb6543.css integrity="sha256-2AX+Lr3v5BKa/9+ZkZIWu/f549btBeG3Q8TkJmzrZUM="><script defer src=/en.search.min.df5fbf4f7be9bd7dd3595d57d605210833b0f20f60cab847c29271b1961cbdfa.js integrity="sha256-31+/T3vpvX3TWV1X1gUhCDOw8g9gyrhHwpJxsZYcvfo="></script><script defer src=/sw.min.74a8bb07f0bee86d6bb9a2750f073f14d93c7e4512f28860370cfd879e9719b4.js integrity="sha256-dKi7B/C+6G1ruaJ1Dwc/FNk8fkUS8ohgNwz9h56XGbQ="></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-138235951-2','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script></head><body dir=ltr><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a href=/><span>Lomorage Documentation</span></a></h2><div class=book-search><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><ul><li class=book-section-flat><a href=https://docs.lomorage.com/docs/Highlight/>Highlight</a><ul></ul></li><li class=book-section-flat><a href=https://docs.lomorage.com/docs/Installation/>Installation</a><ul><li><a href=https://docs.lomorage.com/docs/Installation/lomorage-service/>Lomorage Photo Assistant</a><ul><li><a href=https://docs.lomorage.com/docs/Installation/lomorage-service/installation-raspbian/>Raspbian</a></li><li><a href=https://docs.lomorage.com/docs/Installation/lomorage-service/installation-armbian/>Armbian</a></li><li><a href=https://docs.lomorage.com/docs/Installation/lomorage-service/installation-ubuntu/>Ubuntu</a></li><li><a href=https://docs.lomorage.com/docs/Installation/lomorage-service/installation-win/>Windows</a></li><li><a href=https://docs.lomorage.com/docs/Installation/lomorage-service/installation-osx/>OSX</a></li><li><a href=https://docs.lomorage.com/docs/Installation/lomorage-service/installation-docker/>Docker</a></li><li><a href=https://docs.lomorage.com/docs/Installation/lomorage-service/installation-openwrt/ class=active>Openwrt</a></li><li><a href=https://docs.lomorage.com/docs/Installation/lomorage-service/installation-synology/>Synology</a></li><li><a href=https://docs.lomorage.com/docs/Installation/lomorage-service/installation-unraid/>Unraid</a></li></ul></li><li><a href=https://docs.lomorage.com/docs/Installation/lomorage-client/>Lomorage Client</a><ul><li><a href=https://docs.lomorage.com/docs/Installation/lomorage-client/installation-ios/>iOS</a></li><li><a href=https://docs.lomorage.com/docs/Installation/lomorage-client/installation-android/>Android</a></li><li><a href=https://docs.lomorage.com/docs/Installation/lomorage-client/installation-web/>Web</a></li></ul></li><li><a href=https://docs.lomorage.com/docs/Installation/lomo-frame/>Lomorage Frame</a><ul></ul></li><li class=book-section-flat><a href=https://docs.lomorage.com/docs/Installation/lomorage-importer/>Import Tool</a><ul></ul></li></ul></li><li class=book-section-flat><a href=https://docs.lomorage.com/docs/Usage/>Usage</a><ul><li><a href=https://docs.lomorage.com/docs/Usage/lomorage-client/>Lomorage Command Line Client</a><ul></ul></li><li><a href=https://docs.lomorage.com/docs/Usage/external-access/>External Access</a><ul></ul></li><li><a href=https://docs.lomorage.com/docs/Usage/customized-view/>Customized View</a><ul></ul></li></ul></li><li class=book-section-flat><a href=https://docs.lomorage.com/docs/Roadmap/>Roadmap</a><ul></ul></li></ul><ul><li><a href=https://github.com/lomorage/homepage target=_blank rel=noopener>Github</a></li><li><a href=https://lomorage.com target=_blank rel=noopener>Homepage</a></li></ul></nav><script>(function(){var menu=document.querySelector("aside.book-menu nav");addEventListener("beforeunload",function(event){localStorage.setItem("menu.scrollTop",menu.scrollTop);});menu.scrollTop=localStorage.getItem("menu.scrollTop");})();</script></div></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/svg/menu.svg class=book-icon alt=Menu></label>
<strong>Openwrt</strong>
<label for=toc-control><img src=/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><a href=#openwrt-installation>Openwrt installation</a><ul><li><a href=#quick-start>Quick Start</a><ul><li><a href=#1-install-entware>1. Install Entware</a></li><li><a href=#2-install-lomorage>2. Install Lomorage</a></li></ul></li></ul></li></ul></nav></aside></header><article class=markdown><h1 id=openwrt-installation>Openwrt installation
<a class=anchor href=#openwrt-installation>#</a></h1><p>Lomorage setup using opkg packages with Entware repository (need dependencies in Entware, like ffmpeg exif-tools).</p><p>This is currently in Beta, please reach us if you have any problem.</p><h2 id=quick-start>Quick Start
<a class=anchor href=#quick-start>#</a></h2><p>This is for users who want to setup Lomorage using opkg packets.</p><h3 id=1-install-entware>1. Install Entware
<a class=anchor href=#1-install-entware>#</a></h3><p>Follow the
<a href=https://github.com/Entware/Entware/wiki/Alternative-install-vs-standard>instruction</a> to install Entware on target machine.</p><p>You can use <code>cat /proc/cpuinfo</code> to check the architecture:</p><pre><code>root@OpenWrt:/mnt/sda1# cat /proc/cpuinfo 
system type		: Atheros AR9344 rev 2
machine			: Western Digital My Net N750
processor		: 0
cpu model		: MIPS 74Kc V4.12
BogoMIPS		: 278.93
wait instruction	: yes
microsecond timers	: yes
tlb_entries		: 32
extra interrupt vector	: yes
hardware watchpoint	: yes, count: 4, address/irw mask: [0x0ffc, 0x0ffc, 0x0ffb, 0x0ffb]
isa			: mips1 mips2 mips32r1 mips32r2
ASEs implemented	: mips16 dsp dsp2
Options implemented	: tlb 4kex 4k_cache prefetch mcheck ejtag llsc dc_aliases perf_cntr_intr_bit nan_legacy nan_2008 perf
shadow register sets	: 1
kscratch registers	: 0
package			: 0
core			: 0
VCED exceptions		: not available
VCEI exceptions		: not available
</code></pre><p>If it&rsquo;s MIPS, you can use <code>lscpu</code> to check the byte order, mips is a big-endian mips architecture,. mipsel is a little-endian mips architecture.</p><pre><code>root@OpenWrt:/mnt/sda1# lscpu | grep &quot;Byte Order&quot;
Byte Order:          Big Endian
</code></pre><p>And use <code>uname -a</code> to check Linux version:</p><pre><code>root@OpenWrt:/mnt/sda1# uname -a
Linux OpenWrt 4.14.221 #0 Mon Feb 15 15:22:37 2021 mips GNU/Linux
</code></pre><p>Most likely you need mount USB drive and use that for packages installation, refer to:</p><ol><li><a href=https://openwrt.org/docs/guide-user/storage/usb-drives-quickstart#procedure>https://openwrt.org/docs/guide-user/storage/usb-drives-quickstart#procedure</a></li><li><a href=https://www.jianshu.com/p/4061eeaccd13>https://www.jianshu.com/p/4061eeaccd13</a></li></ol><p><strong>Make sure you change &ldquo;/etc/profile&rdquo; and add <code>/opt/bin/go/bin:/opt/bin</code> in <code>PATH</code> and <code>/opt/lib/</code> in <code>LD_LIBRARY_PATH</code></strong></p><p>Once you have Entware setup ready, install dependencies and tools from Entware repo:</p><pre><code>root@OpenWrt:~# opkg install coreutils-stat perl-image-exiftool ffmpeg ffprobe lsblk
</code></pre><h3 id=2-install-lomorage>2. Install Lomorage
<a class=anchor href=#2-install-lomorage>#</a></h3><p>Architectures supported are:</p><pre><code>aarch64-3.10    # arm64, linux kernel ver &gt;= 3.10
armv7-3.2       # armv7, linux kernel ver &gt;=3.2
mips-3.4        # mips big-endian, linux kernel ver &gt;=3.2
mipsel-3.4      # mips little-endian, linux kernel ver &gt;=3.2
</code></pre><p>Add <code>src/gz lomorage https://lomostaging.lomorage.com/opkg/[architecture]</code> in <code>/opt/etc/opkg.conf</code>, replace <code>[architecture]</code> with those listed above, for example if it&rsquo;s mips big-endian, linux kernel ver >=3.2, use <code>src/gz lomorage https://lomostaging.lomorage.com/opkg/mips-3.4</code>. This should <strong>below &ldquo;entware&rdquo; entry</strong> because some packages in entware are not compiled with needed flags, and need to be overridden.</p><pre><code>root@OpenWrt:~# cat /opt/etc/opkg.conf
src/gz entware http://bin.entware.net/mipssf-k3.4
src/gz lomorage https://lomostaging.lomorage.com/opkg/mips-3.4
dest root /
lists_dir ext /opt/var/opkg-lists
arch all 100
arch mips-3x 150
arch mips-3.4 160
</code></pre><p>And then you can install &ldquo;lomo-backend&rdquo;, all the dependencies should be able to be installed automatically:</p><pre><code>root@OpenWrt:/mnt/sda1/# opkg update --no-check-certificate
root@OpenWrt:/mnt/sda1/# opkg install lomo-backend --no-check-certificate
</code></pre><p>&ldquo;lomod&rdquo; will start automatically after installation, the mount directory is default to &ldquo;/mnt&rdquo; and port default to &ldquo;8000&rdquo;, you can also run:</p><pre><code>root@OpenWrt:/mnt/sda1# /opt/etc/init.d/lomod
Usage: /opt/etc/init.d/lomod {start|stop|restart}
</code></pre><p>Should be notice that for &ldquo;arm&rdquo; architecture, it will has two versions: &ldquo;hf&rdquo; and &ldquo;nohf&rdquo;, &ldquo;hf&rdquo; means hard float, you can check whether the CPU supports hard float by <code>grep "fpu" /proc/cpuinfo</code> and if it shows <code>fpu : yes</code> then it supports hard float. <strong>And if it doesn&rsquo;t support hard float, you should install the following packages instead:</strong></p><pre><code>root@OpenWrt:/mnt/sda1/# opkg install lomo-backend_nohf --no-check-certificate
</code></pre><p>Then you can add cron job to update lomo-backend at 4:00 am everyday:</p><pre><code>root@OpenWrt:~# crontab -e
</code></pre><p>and add the following item:</p><pre><code>0 4 * * * opkg update --no-check-certificate &amp;&amp; opkg install lomo-backend --no-check-certificate
</code></pre></article><footer class=book-footer><div class="flex flex-wrap justify-between"><div class=book-languages tabindex=0 aria-haspopup=true><ul><li class="flex align-center"><img src=/svg/translate.svg class=book-icon alt=Languages>
English</li></ul><ul class=book-languages-list><li class=active><a href=https://docs.lomorage.com/ class="flex align-center"><img src=/svg/translate.svg class=book-icon alt=Languages>
English</a></li><li><a href=https://docs.lomorage.com/zh/docs/Installation/lomorage-service/installation-openwrt/ class="flex align-center"><img src=/svg/translate.svg class=book-icon alt=Languages>
中文</a></li></ul></div><div><a class="flex align-center" href=https://github.com/lomodoc/homepage/commit/d59e6845147269a14ef29fb610dbe93e1db2197c title="Last modified by Jiantao Fu | October 30, 2021" target=_blank rel=noopener><img src=/svg/calendar.svg class=book-icon alt=Calendar>
<span>October 30, 2021</span></a></div><div><a class="flex align-center" href=https://github.com/lomodoc/homepage/edit/main/content/docs/Installation/lomorage-service/installation-openwrt.md target=_blank rel=noopener><img src=/svg/edit.svg class=book-icon alt=Edit>
<span>Edit this page</span></a></div></div></footer><div class=book-comments><div id=disqus_thread></div><script type=application/javascript>var disqus_config=function(){};(function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById('disqus_thread').innerHTML='Disqus comments not available by default when the website is previewed locally.';return;}
var d=document,s=d.createElement('script');s.async=true;s.src='//'+"lomorage"+'.disqus.com/embed.js';s.setAttribute('data-timestamp',+new Date());(d.head||d.body).appendChild(s);})();</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></div><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><nav id=TableOfContents><ul><li><a href=#openwrt-installation>Openwrt installation</a><ul><li><a href=#quick-start>Quick Start</a><ul><li><a href=#1-install-entware>1. Install Entware</a></li><li><a href=#2-install-lomorage>2. Install Lomorage</a></li></ul></li></ul></li></ul></nav></div></aside></main></body></html>