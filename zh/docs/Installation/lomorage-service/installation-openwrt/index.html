<!doctype html><html lang=zh dir=ltr><head><meta name=generator content="Hugo 0.78.1"><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Openwrt安装#Lomorage的opkg包安装依赖Entware软件仓库中的其他包(比如ffmpeg exif-tools)。
当前在Beta测试中，如果您碰到什么问题请联系我们。
快速开始#1. 安装Entware#请参考这里的步骤来安装Entware到目标机上。
您可以使用cat /proc/cpuinfo命令来检查系统架构:
root@OpenWrt:/mnt/sda1# cat /proc/cpuinfo system type	: Atheros AR9344 rev 2machine	: Western Digital My Net N750processor	: 0cpu model	: MIPS 74Kc V4.12BogoMIPS	: 278.93wait instruction	: yesmicrosecond timers	: yestlb_entries	: 32extra interrupt vector	: yeshardware watchpoint	: yes, count: 4, address/irw mask: [0x0ffc, 0x0ffc, 0x0ffb, 0x0ffb]isa	: mips1 mips2 mips32r1 mips32r2ASEs implemented	: mips16 dsp dsp2Options implemented	: tlb 4kex 4k_cache prefetch mcheck ejtag llsc dc_aliases perf_cntr_intr_bit nan_legacy nan_2008 perfshadow register sets	: 1kscratch registers	: 0package	: 0core	: 0VCED exceptions	: not availableVCEI exceptions	: not available如果是MIPS，可以使用 lscpu来查看字节序，mips是big-endian架构,."><meta name=theme-color content="#FFFFFF"><meta property="og:title" content="Openwrt"><meta property="og:description" content="Openwrt安装#Lomorage的opkg包安装依赖Entware软件仓库中的其他包(比如ffmpeg exif-tools)。
当前在Beta测试中，如果您碰到什么问题请联系我们。
快速开始#1. 安装Entware#请参考这里的步骤来安装Entware到目标机上。
您可以使用cat /proc/cpuinfo命令来检查系统架构:
root@OpenWrt:/mnt/sda1# cat /proc/cpuinfo system type	: Atheros AR9344 rev 2machine	: Western Digital My Net N750processor	: 0cpu model	: MIPS 74Kc V4.12BogoMIPS	: 278.93wait instruction	: yesmicrosecond timers	: yestlb_entries	: 32extra interrupt vector	: yeshardware watchpoint	: yes, count: 4, address/irw mask: [0x0ffc, 0x0ffc, 0x0ffb, 0x0ffb]isa	: mips1 mips2 mips32r1 mips32r2ASEs implemented	: mips16 dsp dsp2Options implemented	: tlb 4kex 4k_cache prefetch mcheck ejtag llsc dc_aliases perf_cntr_intr_bit nan_legacy nan_2008 perfshadow register sets	: 1kscratch registers	: 0package	: 0core	: 0VCED exceptions	: not availableVCEI exceptions	: not available如果是MIPS，可以使用 lscpu来查看字节序，mips是big-endian架构,."><meta property="og:type" content="article"><meta property="og:url" content="https://docs.lomorage.com/zh/docs/Installation/lomorage-service/installation-openwrt/"><meta property="article:modified_time" content="2021-10-30T23:09:23-07:00"><meta property="og:site_name" content="Lomorage文档"><title>Openwrt | Lomorage文档</title><link rel=manifest href=/manifest.json><link rel=icon href=/favicon.png type=image/x-icon><link rel=alternate hreflang=en href=https://docs.lomorage.com/docs/Installation/lomorage-service/installation-openwrt/ title=Openwrt><link rel=stylesheet href=/book.min.d805fe2ebdefe4129affdf99919216bbf7f9e3d6ed05e1b743c4e4266ceb6543.css integrity="sha256-2AX+Lr3v5BKa/9+ZkZIWu/f549btBeG3Q8TkJmzrZUM="><script defer src=/zh.search.min.a2ef04c611421553b29faf6959877a151185645f6abe41d214efe86c9e5dae43.js integrity="sha256-ou8ExhFCFVOyn69pWYd6FRGFZF9qvkHSFO/obJ5drkM="></script><script defer src=/sw.min.74a8bb07f0bee86d6bb9a2750f073f14d93c7e4512f28860370cfd879e9719b4.js integrity="sha256-dKi7B/C+6G1ruaJ1Dwc/FNk8fkUS8ohgNwz9h56XGbQ="></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-138235951-2','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script></head><body dir=ltr><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a href=/zh><span>Lomorage文档</span></a></h2><div class=book-search><input type=text id=book-search-input placeholder=搜索 aria-label=搜索 maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><ul><li class=book-section-flat><a href=https://docs.lomorage.com/zh/docs/Highlight/>功能</a><ul></ul></li><li class=book-section-flat><a href=https://docs.lomorage.com/zh/docs/Installation/>安装</a><ul><li><a href=https://docs.lomorage.com/zh/docs/Installation/lomorage-service/>Lomorage照片助手</a><ul><li><a href=https://docs.lomorage.com/zh/docs/Installation/lomorage-service/installation-raspbian/>Raspbian</a></li><li><a href=https://docs.lomorage.com/zh/docs/Installation/lomorage-service/installation-armbian/>Armbian</a></li><li><a href=https://docs.lomorage.com/zh/docs/Installation/lomorage-service/installation-ubuntu/>Ubuntu</a></li><li><a href=https://docs.lomorage.com/zh/docs/Installation/lomorage-service/installation-win/>Windows</a></li><li><a href=https://docs.lomorage.com/zh/docs/Installation/lomorage-service/installation-osx/>OSX</a></li><li><a href=https://docs.lomorage.com/zh/docs/Installation/lomorage-service/installation-docker/>Docker</a></li><li><a href=https://docs.lomorage.com/zh/docs/Installation/lomorage-service/installation-openwrt/ class=active>Openwrt</a></li><li><a href=https://docs.lomorage.com/zh/docs/Installation/lomorage-service/installation-unraid/>Unraid</a></li><li><a href=https://docs.lomorage.com/zh/docs/Installation/lomorage-service/installation-synology/>群晖</a></li></ul></li><li><a href=https://docs.lomorage.com/zh/docs/Installation/lomorage-client/>Lomorage客户端</a><ul><li><a href=https://docs.lomorage.com/zh/docs/Installation/lomorage-client/installation-ios/>iOS</a></li><li><a href=https://docs.lomorage.com/zh/docs/Installation/lomorage-client/installation-android/>Andriod</a></li><li><a href=https://docs.lomorage.com/zh/docs/Installation/lomorage-client/installation-web/>Web</a></li></ul></li><li><a href=https://docs.lomorage.com/zh/docs/Installation/lomo-frame/>Lomorage相框</a><ul></ul></li><li class=book-section-flat><a href=https://docs.lomorage.com/zh/docs/Installation/lomorage-importer/>导入工具</a><ul></ul></li></ul></li><li class=book-section-flat><a href=https://docs.lomorage.com/zh/docs/Usage/>使用说明</a><ul><li><a href=https://docs.lomorage.com/zh/docs/Usage/lomorage-client/>命令行工具</a><ul></ul></li><li><a href=https://docs.lomorage.com/zh/docs/Usage/Update/>手工升级Lomoarge后台系统</a><ul></ul></li><li><a href=https://docs.lomorage.com/zh/docs/Usage/external-access/>外网访问</a><ul></ul></li><li><a href=https://docs.lomorage.com/zh/docs/Usage/customized-view/>自定义视图</a><ul></ul></li></ul></li><li class=book-section-flat><a href=https://docs.lomorage.com/zh/docs/Roadmap/>产品路线图</a><ul></ul></li></ul><ul><li><a href=https://github.com/lomorage/homepage target=_blank rel=noopener>Github</a></li><li><a href=https://lomorage.com target=_blank rel=noopener>主页</a></li></ul></nav><script>(function(){var menu=document.querySelector("aside.book-menu nav");addEventListener("beforeunload",function(event){localStorage.setItem("menu.scrollTop",menu.scrollTop);});menu.scrollTop=localStorage.getItem("menu.scrollTop");})();</script></div></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/svg/menu.svg class=book-icon alt=Menu></label>
<strong>Openwrt</strong>
<label for=toc-control><img src=/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><a href=#openwrt安装>Openwrt安装</a><ul><li><a href=#快速开始>快速开始</a><ul><li><a href=#1-安装entware>1. 安装Entware</a></li><li><a href=#2-安装lomorage>2. 安装Lomorage</a></li></ul></li></ul></li></ul></nav></aside></header><article class=markdown><h1 id=openwrt安装>Openwrt安装
<a class=anchor href=#openwrt%e5%ae%89%e8%a3%85>#</a></h1><p>Lomorage的opkg包安装依赖Entware软件仓库中的其他包(比如ffmpeg exif-tools)。</p><p>当前在Beta测试中，如果您碰到什么问题请联系我们。</p><h2 id=快速开始>快速开始
<a class=anchor href=#%e5%bf%ab%e9%80%9f%e5%bc%80%e5%a7%8b>#</a></h2><h3 id=1-安装entware>1. 安装Entware
<a class=anchor href=#1-%e5%ae%89%e8%a3%85entware>#</a></h3><p>请参考
<a href=https://github.com/Entware/Entware/wiki/Alternative-install-vs-standard>这里</a>的步骤来安装Entware到目标机上。</p><p>您可以使用<code>cat /proc/cpuinfo</code>命令来检查系统架构:</p><pre><code>root@OpenWrt:/mnt/sda1# cat /proc/cpuinfo 
system type		: Atheros AR9344 rev 2
machine			: Western Digital My Net N750
processor		: 0
cpu model		: MIPS 74Kc V4.12
BogoMIPS		: 278.93
wait instruction	: yes
microsecond timers	: yes
tlb_entries		: 32
extra interrupt vector	: yes
hardware watchpoint	: yes, count: 4, address/irw mask: [0x0ffc, 0x0ffc, 0x0ffb, 0x0ffb]
isa			: mips1 mips2 mips32r1 mips32r2
ASEs implemented	: mips16 dsp dsp2
Options implemented	: tlb 4kex 4k_cache prefetch mcheck ejtag llsc dc_aliases perf_cntr_intr_bit nan_legacy nan_2008 perf
shadow register sets	: 1
kscratch registers	: 0
package			: 0
core			: 0
VCED exceptions		: not available
VCEI exceptions		: not available
</code></pre><p>如果是MIPS，可以使用 <code>lscpu</code>来查看字节序，mips是big-endian架构,. mipsel是little-endian架构。</p><pre><code>root@OpenWrt:/mnt/sda1# lscpu | grep &quot;Byte Order&quot;
Byte Order:          Big Endian
</code></pre><p>然后您可以使用<code>uname -a </code>查看Linux版本号:</p><pre><code>root@OpenWrt:/mnt/sda1# uname -a
Linux OpenWrt 4.14.221 #0 Mon Feb 15 15:22:37 2021 mips GNU/Linux
</code></pre><p>通常您需要加载USB驱动器，并将包安装到上面，参考:</p><ol><li><a href=https://openwrt.org/docs/guide-user/storage/usb-drives-quickstart#procedure>https://openwrt.org/docs/guide-user/storage/usb-drives-quickstart#procedure</a></li><li><a href=https://www.jianshu.com/p/4061eeaccd13>https://www.jianshu.com/p/4061eeaccd13</a></li></ol><p><strong>确保修改了"/etc/profile"，添加<code>/opt/bin/go/bin:/opt/bin</code>到<code>PATH</code>，添加<code>/opt/lib/</code>到<code>LD_LIBRARY_PATH</code></strong></p><p>Entware安装好了后，可以从Entware安装下面的依赖和工具:</p><pre><code>root@OpenWrt:~# opkg install coreutils-stat perl-image-exiftool ffmpeg ffprobe lsblk
</code></pre><h3 id=2-安装lomorage>2. 安装Lomorage
<a class=anchor href=#2-%e5%ae%89%e8%a3%85lomorage>#</a></h3><p>现在支持的系统平台如下:</p><pre><code>aarch64-3.10    # arm64, linux kernel ver &gt;= 3.10
armv7-3.2       # armv7, linux kernel ver &gt;=3.2
mips-3.4        # mips big-endian, linux kernel ver &gt;=3.2
mipsel-3.4      # mips little-endian, linux kernel ver &gt;=3.2
</code></pre><p>添加<code>src/gz lomorage https://lomostaging.lomorage.com/opkg/[architecture]</code>到<code>/opt/etc/opkg.conf</code>，将<code>[architecture]</code>替换为你的系统架构，比如如果是mips big-endian, linux kernel ver >=3.2, 使用<code>src/gz lomorage https://lomostaging.lomorage.com/opkg/mips-3.4</code>。必须将其放置到 <strong>&ldquo;entware&rdquo; 条目的下面</strong>，因为entware中有些需要的包没有打开需要的编译选项，需要使用Lomorage源中的包。</p><pre><code>root@OpenWrt:~# cat /opt/etc/opkg.conf
src/gz entware http://bin.entware.net/mipssf-k3.4
src/gz lomorage https://lomostaging.lomorage.com/opkg/mips-3.4
dest root /
lists_dir ext /opt/var/opkg-lists
arch all 100
arch mips-3x 150
arch mips-3.4 160
</code></pre><p>然后您可以安装"lomo-backend"，所有的依赖应该都能自动安装:</p><pre><code>root@OpenWrt:/mnt/sda1/# opkg update --no-check-certificate
root@OpenWrt:/mnt/sda1/# opkg install lomo-backend --no-check-certificate
</code></pre><p>&ldquo;lomod"安装完成后会自动启动，默认的加载目录是&rdquo;/mnt"，端口号"8000"，你也可以使用下面的命令控制:</p><pre><code>root@OpenWrt:/mnt/sda1# /opt/etc/init.d/lomod
Usage: /opt/etc/init.d/lomod {start|stop|restart}
</code></pre><p>需要注意的是对于"arm"架构，会有两个版本: &ldquo;hf&rdquo; and &ldquo;nohf&rdquo;, &ldquo;hf"是hard float的缩写，可以通过<code>grep "fpu" /proc/cpuinfo</code>来查看CPU是否支持hard float，如果命令输出显示<code>fpu : yes</code>那就是支持. <strong>如果不支持hard float，您需要安装nohf版本的包:</strong></p><pre><code>root@OpenWrt:/mnt/sda1/# opkg install lomo-backend_nohf --no-check-certificate
</code></pre><p>接下来您可以使用cron job来每天4:00 am自动更新lomo-backend:</p><pre><code>root@OpenWrt:~# crontab -e
</code></pre><p>添加下面的内容:</p><pre><code>0 4 * * * opkg update --no-check-certificate &amp;&amp; opkg install lomo-backend --no-check-certificate
</code></pre></article><footer class=book-footer><div class="flex flex-wrap justify-between"><div class=book-languages tabindex=0 aria-haspopup=true><ul><li class="flex align-center"><img src=/svg/translate.svg class=book-icon alt=Languages>
中文</li></ul><ul class=book-languages-list><li><a href=https://docs.lomorage.com/docs/Installation/lomorage-service/installation-openwrt/ class="flex align-center"><img src=/svg/translate.svg class=book-icon alt=Languages>
English</a></li><li class=active><a href=https://docs.lomorage.com/zh/ class="flex align-center"><img src=/svg/translate.svg class=book-icon alt=Languages>
中文</a></li></ul></div><div><a class="flex align-center" href=https://github.com/lomodoc/homepage/commit/d59e6845147269a14ef29fb610dbe93e1db2197c title="最后修改者 Jiantao Fu | October 30, 2021" target=_blank rel=noopener><img src=/svg/calendar.svg class=book-icon alt=Calendar>
<span>October 30, 2021</span></a></div><div><a class="flex align-center" href=https://github.com/lomodoc/homepage/edit/main/content.zh/docs/Installation/lomorage-service/installation-openwrt.md target=_blank rel=noopener><img src=/svg/edit.svg class=book-icon alt=Edit>
<span>编辑本页</span></a></div></div></footer><div class=book-comments><div id=disqus_thread></div><script type=application/javascript>var disqus_config=function(){};(function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById('disqus_thread').innerHTML='Disqus comments not available by default when the website is previewed locally.';return;}
var d=document,s=d.createElement('script');s.async=true;s.src='//'+"lomorage"+'.disqus.com/embed.js';s.setAttribute('data-timestamp',+new Date());(d.head||d.body).appendChild(s);})();</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></div><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><nav id=TableOfContents><ul><li><a href=#openwrt安装>Openwrt安装</a><ul><li><a href=#快速开始>快速开始</a><ul><li><a href=#1-安装entware>1. 安装Entware</a></li><li><a href=#2-安装lomorage>2. 安装Lomorage</a></li></ul></li></ul></li></ul></nav></div></aside></main></body></html>